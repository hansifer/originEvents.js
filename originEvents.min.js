// originEvents.js 0.1.0
// https://github.com/hansifer/originEvents.js
// (c) 2013 Hans Meyer; Licensed MIT

(function(){var a=this,b=0,c="originEvents.nooxis.com.",d=c+uuid.v4()+".",e=new RegExp("^"+c.replace(".","\\.")+"[0-9a-f]{32}\\.\\d+$"),f=!1,g=!1,h=!1,i={},j=function(a){a.newValue&&e.test(a.key)&&a.key.substring(0,d.length)!==d&&l(snorkel.decodeValue(a.newValue),!1)},k=function(a,b,c){("updated"===a||"added"===a)&&(g&&l(c,!0),snorkel.remove(b))},l=function(a,b){_.each(i[a.type],function(c){c.call(a,b)})},m={};m.on=function(a,b){a in i||(i[a]=[]),_.contains(i[a],b)||i[a].push(b)},m.off=function(a,b){a in i&&(b?i[a].splice(i[a].indexOf(b),1):delete i[a])},m.trigger=function(a,c){f&&snorkel.set(d+b++,{datetime:new Date,type:a,message:c})},m.triggerEnabled=function(a){return arguments.length&&(a&&!f?snorkel.on(k,e):!a&&f&&snorkel.off(k,e),f=a),f},m.localListenerEnabled=function(a){return arguments.length&&(g=a),g},m.remoteListenerEnabled=function(b){return arguments.length&&(b&&!h?a.addEventListener("storage",j,!1):!b&&h&&a.removeEventListener("storage",j,!1),h=b),h},m.triggerEnabled(!0),m.remoteListenerEnabled(!0),m.localListenerEnabled(!0),a.originEvents=m}).call(this);